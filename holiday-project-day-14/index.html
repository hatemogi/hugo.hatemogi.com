<!DOCTYPE html>
<html lang="ko">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:title" content="프로젝트 14일: Heroku에 Node.js 애플리케이션 배포">
  <meta property="og:type" content="website">
  <meta property="og:image" content="">
  <meta property="og:url" content="http://hatemogi.com/holiday-project-day-14/">
  <meta property="og:description" content="소프트웨어 개발자, 김대현의 블로그">
  <title>프로젝트 14일: Heroku에 Node.js 애플리케이션 배포</title>
  <link rel="canonical" href="http://hatemogi.com/holiday-project-day-14/">
  <link rel="stylesheet" href="/css/bootstrap.flatly.css">
  <link rel="stylesheet" href="/css/bootstrap-social.css">
  <link rel="stylesheet" href="/css/highlight/github.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/awjordan.css">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/highlight.pack.js"></script>
  <script src="/js/d3.min.js"></script>
  <script src="/js/hatemogi.js"></script>
</head>
<body>

<nav class="navbar navbar-default navbar-static-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand logo" href="/">
      hatemogi
      </a>
    </div>
    <ul class="nav navbar-nav">
      <li><a href="/about">소개</a></li>
      <li><a href="/post">블로그</a></li>
      
      
    </ul>
    <ul class="nav navbar-nav hidden-xs navbar-right">
      <li><a href="https://twitter.com/@hatemogi"><i class="fa fa-twitter fa-lg"></i></a></li>
      <li><a href="https://github.com/hatemogi"><i class="fa fa-github fa-lg"></i></a></li>
      <li><a href="https://medium.com/hatemogi"><i class="fa fa-medium fa-lg"></i></a></li>
    </ul>
  </div>
</nav>

<div class="layout">
  <ol class="breadcrumb">
    <li><a href="/">홈</a></li>
    <li><a href="/post">블로그</a></li>
    <li class="active">프로젝트 14일: Heroku에 Node.js 애플리케이션 배포</li>
  </ol>

  <div class="pure-u-1">
    
    <div class="posts">
      
      <section class="post">
        <header class="post-header">
          <h2 class="post-title">
            프로젝트 14일: Heroku에 Node.js 애플리케이션 배포
          </h2>

          <p class="post-meta">
            <i class="fa fa-calendar-o"></i>
            2014-05-20
            
          </p>
        </header>

        <div class="post-description">
          

<p>프로젝트 14일째, 오늘은 데모 웹사이트를 만들어 올리기 위해, (1) 노드용 템플릿 엔진인 <a href="http://jade-lang.com/">Jade</a>를 잠깐 써보고, (2) Heroku에 지금까지 만들고 있는 <a href="https://github.com/hatemogi/holiday-project">express 웹앱</a>을 배포해봤다.</p>

<h2 id="node-js-템플릿-엔진-jade:f1c5f909337c73dfa7f624663e8d9a59">Node.js 템플릿 엔진 - Jade</h2>

<p>루비 쪽의 <a href="http://haml.info/">Haml</a>과 같은 템플릿 엔진이다. 간결한 문법과 들여쓰기로, HTML/XML 태그를 여닫는 번거로움 없이 간편하게 결과 페이지를 만들 수 있다. 이하는 오늘 작성한 템플릿 레이아웃의 일부다.</p>

<h3 id="layout-jade-https-github-com-hatemogi-holiday-project-blob-day-14-views-layout-jade-의-일부:f1c5f909337c73dfa7f624663e8d9a59"><a href="https://github.com/hatemogi/holiday-project/blob/day-14/views/layout.jade">layout.jade</a>의 일부</h3>

<pre><code class="language-jade">doctype html
html
  head(prefix=&quot;og: http://ogp.me/ns#&quot;)
    meta(charset=&quot;utf-8&quot;)
    meta(name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;)
    title= title
    link(rel='stylesheet' href='/bower_components/bootstrap/dist/css/bootstrap.min.css')
    script(src='/bower_components/jquery/dist/jquery.min.js')
    script(src='/bower_components/bootstrap/dist/js/bootstrap.min.js')
  body
    block content
    include ga
    include github_badge
</code></pre>

<p>위와 같은 모습인데, HTML 문서의 태그를 들여쓰기로 어느 부분까지 감싸는 것인지 표현한다. 각종 태그를 그대로 쓰면 되고, 괄호 안의 속성값이 그대로 해당 element의 속성이 된다. 중간중간 현재 문맥에 바인딩 된 값을 가져다 쓸 수 있다. 위 레이아웃에서는 <code>title</code> 태그의 값이 그렇게 사용된다.</p>

<p>body 태그 바로 아래에 <code>block content</code> 부분이 실제 본문 내용이 대치/입력돼 최종 출력된다고 보면 된다. <code>include</code>는 말 그대로 별도 템플릿을 읽는다.</p>

<p>템플릿 엔진이야 워낙 다양하고, 어떤 언어와 웹서비스 프레임워크를 쓰느냐 만큼 개인별 호불호가 달라서, 스스로 마음에 드는 템플릿 엔진을 골라서 사용하면 된다.</p>

<h2 id="heroku에-배포:f1c5f909337c73dfa7f624663e8d9a59">Heroku에 배포</h2>

<p>프로젝트가 잘 진행되어, 웹 애플리케이션을 올려서 공개한다면, 아마도 <a href="http://aws.amazon.com/ko/ec2/">AWS EC2</a>나 <a href="https://cloud.google.com/products/compute-engine/">Google Compute Engine</a>에 직접 구축해서 올릴 테지만, 아직 그런 단계는 아니고, 이 블로그를 읽고 있는 소수의 지인께만 보여드리는 데모 웹페이지가 필요한 정도다.</p>

<p><a href="https://heroku.com/">Heroku</a>는 각종 웹 애플리케이션을 올려서 서비스할 수 있는 클라우드 서비스인데, 스타트업들이 즐겨 사용하는 플랫폼이다. 개인적으로는 <a href="http://hatemogi.com/saas_class/">2012년에 Coursera에서 SaaS 수업</a>을 들으며 써본 적이 있는데, 좋은 인상을 받았던 서비스다.</p>

<p>로컬에서 잘 개발하고, heroku에 생성한 앱의 git 저장소 주소로 push하면 해당 애플리케이션이 배포되며, 곧바로 <code>앱이름.herokuapp.com</code>에서 접근해 확인할 수 있다. 직접 서버를 설치하고 구동하고 관리할 필요없이 <code>git push heroku</code>만으로 배포되고, 그 후 운영은 heroku가 알아서 한다.</p>

<p><img src="/img/holiday-project/heroku-dashboard.png" style="width: 600px;"/></p>

<p>이번 데모를 위해서 최소 자원을 받았고, 개발용 Postgres 인스턴스도 add-on으로 붙인 화면이다. 비록 1만 레코드까지만 쓸 수 있는, 정말 개발시연용이지만, 지금의 목표에는 충분히 활용할 수 있다. 무엇보다도, 데모를 위한 규모에서는 <strong>무료로 서비스를 이용</strong>할 수 있다. 보이는가? 월 예상비용 $0.00 !!!</p>

<p><a href="https://twitter.com/hatemogi/status/399814963360849920">개인적으로는 프로젝트 초기에는 그냥 간단히 가볍게 SQLite 활용하자는 마인드</a>지만, Heroku 특성상, 일단 무료 Postgres를 써보기로 한다.</p>

<p>배포 중에 발생한 한가지 문제는, <a href="/holiday-project-day-04/">프로젝트 4일 차에 알아본 Bower</a>로 가져다 쓴 Bootstrap과 jQuery를 Heroku에 배포한 앱에서는 설치되지 않았던 점이 있다. 프로젝트 배포하고 <code>bower install</code>을 실행해야 하는데, Heroku에서 기본으로 그 커맨드를 실행할 이유는 없는 것. 검색을 좀 해보니, 무슨 Heroku의 빌드팩이라는 걸 만들어서 해결하는 방법이 있던데, 뭘 그렇게까지 해야 하나 싶어서 좀 더 검색해보니, <a href="http://xseignard.github.io/2013/02/18/use-bower-with-heroku/">아주 간단하게 해결한 방법</a>을 찾을 수 있었다.</p>

<p><code>package.json</code>의 <code>scripts</code> 부분에 <code>postinstall</code>이라는 항목에, 실행할 스크립트를 넣어 놓으면 <code>npm install</code>이 진행되고 나서 이 스크립트를 실행하게 되는데, 이 부분을 이용하는 것.</p>

<pre><code class="language-json">  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node ./bin/www&quot;,
    &quot;karma&quot;: &quot;./node_modules/karma/bin/karma start&quot;,
    &quot;spec&quot;: &quot;./node_modules/jasmine-node/bin/jasmine-node --coffee --verbose spec&quot;,
    &quot;postinstall&quot;: &quot;./node_modules/bower/bin/bower install&quot;
  },
</code></pre>

<p>이렇게 간단하게 웹서비스 실행 전에 <code>bower install</code>을 실행할 수 있다. 한 가지 단점은, 이 커맨드를 실행하기 위해, (실제 실행 때에는 필요하지 않은) bower 의존성을 걸어야 한다는 점이 있으나, 무시할만하다.</p>

<p>그렇게 해서, 결국 데모 앱을 준비했다. 아직 뭐 하는 기능은 없고, 단지 Heroku에 <strong>텅 빈</strong> express 앱을 띄워 놓은 것. 차차 여기에 살을 붙이기로 한다.</p>

<blockquote>
<p><a href="http://holiday-project.hatemogi.com/">http://holiday-project.hatemogi.com/</a></p>
</blockquote>

<p>(위 주소에 heroku 서비스를 올려놓았으나, 아직은 방문하지 말아달라. ^^;)</p>

<p>한가지 전혀 다른 얘기로, Heroku add-on을 살펴보다가 Redis addon을 슬쩍 봤는데, 아래 캡처이미지에 보이듯, 3만8천 개 인스턴스를 서비스하고 있단다. 회사 업무로 우리 팀이 하는 일 중 하나가, 사내에 Redis 인스턴스 클라우드스럽게(?) 제공해주고 운영하는 일인데, 이거 외부에서 장사해도 될만한 일이었구나하는 뒤늦은 아쉬움이 든다.</p>

<p><img src="/img/holiday-project/redis-to-go.png" style="width: 600px;"/></p>

<p>3만8천 개라니&hellip; 대단하다. 장사 잘되는구나?!</p>

<p>오늘은 여기까지.</p>

        </div>
      </section>
    </div>
  </div>
</div>

<nav class="container">
  <ul class="pager">
    
      <li class="previous"><a href="http://hatemogi.com/holiday-project-day-13/"><i class="fa fa-chevron-left"></i> 프로젝트 13일: 컨테이너 기반 가상화 프레임워크 - Docker </a></li>
    
    
      <li class="next"><a href="http://hatemogi.com/holiday-project-day-15/">프로젝트 15일: AngularJS 코드스쿨 강좌 소개 <i class="fa fa-chevron-right"></i></a></li>
    
  </ul>
</nav>


<div class="container layout">
<h3>30일 프로젝트 글목록</h3>
<ul class="list-unstyled">
  <li><a href="/holiday-project-day-01/">(05/07) 프로젝트 1일: 웹 브라우저 JS 테스트 환경 - karma &amp; jasmine</a></li>
  <li><a href="/holiday-project-day-02/">(05/08) 프로젝트 2일: 서버 측 JS 테스트 환경 - jasmine-node</a></li>
  <li><a href="/holiday-project-day-03/">(05/09) 프로젝트 3일: express 테스트 환경 - supertest</a></li>
  <li><a href="/holiday-project-day-04/">(05/10) 프로젝트 4일: 웹 환경 패키지 매니저 - bower</a></li>
  <li><a href="/holiday-project-day-05/">(05/11) 프로젝트 5일: 문법 하이라이팅 - highlight.js</a></li>
  <li><a href="/holiday-project-day-06/">(05/12) 프로젝트 6일: 그래프 그리기 - graphviz &amp; D3.js</a></li>
  <li><a href="/holiday-project-day-07/">(05/13) 프로젝트 7일: graphviz 노드에 웹 링크 걸기</a></li>
  <li><a href="/holiday-project-day-08/">(05/14) 프로젝트 8일: D3.js 트랜지션(Transitions)</a></li>
  <li><a href="/holiday-project-day-09/">(05/15) 프로젝트 9일: Node.js로 Git저장소 다루기</a></li>
  <li><a href="/holiday-project-day-10/">(05/16) 프로젝트 10일: Async.js로 콜백 중첩을 풀기</a></li>
  <li><a href="/holiday-project-day-11/">(05/17) 프로젝트 11일: Git 커밋 그래프 그리기 도전</a></li>
  <li><a href="/holiday-project-day-12/">(05/18) 프로젝트 12일: 그래프 그리기 도전 #2</a></li>
  <li><a href="/holiday-project-day-13/">(05/19) 프로젝트 13일: 컨테이너 기반 가상화 프레임워크 - Docker</a></li>
  <li><a href="/holiday-project-day-14/">(05/20) 프로젝트 14일: Heroku에 Node.js 애플리케이션 배포</a></li>
  <li><a href="/holiday-project-day-15/">(05/21) 프로젝트 15일: AngularJS 코드스쿨 강좌 소개</a></li>
  <li><a href="/holiday-project-day-16/">(05/22) 프로젝트 16일: 중간 점검 - 왜 이 프로젝트를 하나?</a></li>
  <li><a href="/holiday-project-day-17/">(05/23) 프로젝트 17일: Travis CI - 지속적 통합 서비스</a></li>
  <li><a href="/holiday-project-day-18/">(05/24) 프로젝트 18일: Grunt - 자바스크립트 작업 실행기</a></li>
  <li><a href="/holiday-project-day-19/">(05/25) 프로젝트 19일: RequireJS - 비동기(async) JS 로더’</a></li>
  <li><a href="/holiday-project-day-20/">(05/26) 프로젝트 20일: 회사의 합병 소식</a></li>
  <li><a href="/holiday-project-day-21/">(05/29) 프로젝트 21일: AngularJS 컨트롤러 테스트 코드</a></li>
  <li><a href="/holiday-project-day-22/">(05/31) 프로젝트 22일: Promise와 Async.js로 작성해본 콜백 코드 비교</a></li>
  <li><a href="/holiday-project-last-day/">(06/08) 프로젝트 마지막날: 결과물 미리보기</a></li>
</ul>
</div>

  <footer>
    copyright(c) 2015 hatemogi
  </footer>
  <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8995709-3', 'auto');
  ga('send', 'pageview');
  </script>
</body>
</html>
